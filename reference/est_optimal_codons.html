<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimate optimal codons — est_optimal_codons • cubar</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate optimal codons — est_optimal_codons"><meta name="description" content="est_optimal_codons determine optimal codon of each codon family with binomial regression.
  Usage of optimal codons should correlate negatively with enc."><meta property="og:description" content="est_optimal_codons determine optimal codon of each codon family with binomial regression.
  Usage of optimal codons should correlate negatively with enc."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">cubar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/cubar.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/codon_optimization.html">Codon optimization</a></li>
    <li><a class="dropdown-item" href="../articles/non_standard_genetic_code.html">Non-standard genetic code</a></li>
    <li><a class="dropdown-item" href="../articles/theory.html">Theories behind cubar</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mt1022/cubar/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Estimate optimal codons</h1>
      <small class="dont-index">Source: <a href="https://github.com/mt1022/cubar/blob/main/R/codon_weight.R" class="external-link"><code>R/codon_weight.R</code></a></small>
      <div class="d-none name"><code>est_optimal_codons.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>est_optimal_codons</code> determine optimal codon of each codon family with binomial regression.
  Usage of optimal codons should correlate negatively with enc.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">est_optimal_codons</span><span class="op">(</span></span>
<span>  <span class="va">cf</span>,</span>
<span>  codon_table <span class="op">=</span> <span class="fu"><a href="get_codon_table.html">get_codon_table</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  level <span class="op">=</span> <span class="st">"subfam"</span>,</span>
<span>  gene_score <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fdr <span class="op">=</span> <span class="fl">0.001</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-cf">cf<a class="anchor" aria-label="anchor" href="#arg-cf"></a></dt>
<dd><p>matrix of codon frequencies as calculated by <code><a href="count_codons.html">count_codons()</a></code>.</p></dd>


<dt id="arg-codon-table">codon_table<a class="anchor" aria-label="anchor" href="#arg-codon-table"></a></dt>
<dd><p>a table of genetic code derived from <code>get_codon_table</code> or <code>create_codon_table</code>.</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>"subfam" (default) or "amino_acid". For which level to determine optimal codons.</p></dd>


<dt id="arg-gene-score">gene_score<a class="anchor" aria-label="anchor" href="#arg-gene-score"></a></dt>
<dd><p>a numeric vector of scores for genes. The order of values should match with
gene orders in the codon frequency matrix. The length of the vector should be equal to the
number of rows in the matrix. The scores could be gene expression levels (RPKM or TPM) that are
optionally log-transformed (for example, with <code>log1p</code>). The opposite of ENC will be used by
default if <code>gene_score</code> is not provided.</p></dd>


<dt id="arg-fdr">fdr<a class="anchor" aria-label="anchor" href="#arg-fdr"></a></dt>
<dd><p>false discovery rate used to determine optimal codons.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>data.table of optimal codons.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># perform binomial regression for optimal codon estimation</span></span></span>
<span class="r-in"><span><span class="va">cf_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="count_codons.html">count_codons</a></span><span class="op">(</span><span class="va">yeast_cds</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">codons_opt</span> <span class="op">&lt;-</span> <span class="fu">est_optimal_codons</span><span class="op">(</span><span class="va">cf_all</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">codons_opt</span> <span class="op">&lt;-</span> <span class="va">codons_opt</span><span class="op">[</span><span class="va">optimal</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">codons_opt</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     aa_code amino_acid  codon subfam       coef        pvalue        qvalue</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;char&gt;     &lt;char&gt; &lt;char&gt; &lt;char&gt;      &lt;num&gt;         &lt;num&gt;         &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:       A        Ala    GCT Ala_GC 0.08454964  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:       A        Ala    GCC Ala_GC 0.01621930  2.127082e-32  2.359128e-32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:       R        Arg    AGA Arg_AG 0.12902657  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:       R        Arg    CGT Arg_CG 0.20090361  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:       N        Asn    AAC Asn_AA 0.04208269 8.024342e-185 1.223712e-184</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:       D        Asp    GAC Asp_GA 0.01574961  3.398292e-28  3.636768e-28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:       C        Cys    TGT Cys_TG 0.09889375 4.697718e-150 6.512746e-150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:       Q        Gln    CAA Gln_CA 0.11196536  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:       E        Glu    GAA Glu_GA 0.08458541  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:       G        Gly    GGT Gly_GG 0.16530194  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:       H        His    CAC His_CA 0.03127977  7.294628e-42  8.240228e-42</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:       I        Ile    ATT Ile_AT 0.03956734 1.625599e-208 2.754487e-208</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:       I        Ile    ATC Ile_AT 0.03975891 1.099697e-188 1.765303e-188</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:       L        Leu    CTT Leu_CT 0.02178829  6.897132e-23  7.253880e-23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:       L        Leu    CTA Leu_CT 0.05101078 7.732994e-124 1.025462e-123</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:       L        Leu    TTG Leu_TT 0.03514392 7.751784e-158 1.125854e-157</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17:       K        Lys    AAG Lys_AA 0.05853116  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18:       F        Phe    TTC Phe_TT 0.05451940 3.720900e-254 7.092965e-254</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19:       P        Pro    CCA Pro_CC 0.10328272  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20:       S        Ser    AGT Ser_AG 0.02452355  2.109510e-19  2.144669e-19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21:       S        Ser    TCT Ser_TC 0.06070916  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22:       S        Ser    TCC Ser_TC 0.02605206  1.324126e-70  1.583759e-70</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23:       T        Thr    ACT Thr_AC 0.04838553 2.506592e-292 5.272486e-292</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24:       T        Thr    ACC Thr_AC 0.04684950 2.157821e-230 3.760774e-230</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25:       Y        Tyr    TAC Tyr_TA 0.04206093 1.244976e-121 1.582157e-121</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26:       V        Val    GTT Val_GT 0.05787243  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27:       V        Val    GTC Val_GT 0.04995247 1.700719e-281 3.458128e-281</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     aa_code amino_acid  codon subfam       coef        pvalue        qvalue</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     optimal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;lgcl&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:    TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:    TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:    TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:    TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:    TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:    TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:    TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:    TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:    TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:    TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:    TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:    TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:    TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:    TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:    TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:    TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17:    TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18:    TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19:    TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20:    TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21:    TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22:    TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23:    TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24:    TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25:    TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26:    TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27:    TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     optimal</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Hong Zhang, Mengyue Liu, Bu Zi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

